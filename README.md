# huligany
**huligany**  ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤,  –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏ –∏—Ö —É–≥—Ä–æ–∑—ã –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É —Ç–µ–±—è –≤ –ø–∞–ø–∫–µ —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º –±—É–¥–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
huligany/
‚îú‚îÄ‚îÄ huligany1.7.py          # –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ utils.py                # –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ rules.py                # —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ (ip_rules.json, subnet_rules.json)
‚îú‚îÄ‚îÄ ip_rules.json           # –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö IP (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)
‚îú‚îÄ‚îÄ subnet_rules.json       # –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è /24 –ø–æ–¥—Å–µ—Ç–µ–π (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)
‚îî‚îÄ‚îÄ results/                # —Å—é–¥–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã
```
## –ó–∞–ø—É—Å–∫
### 1. –ü–æ–¥–≥–æ—Ç–æ–≤—å –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Ñ–æ—Ä–º–∞—Ç–∞:
```
IP	Count
1.2.3.4	15
5.6.7.8	3
9.10.11.12	4
```
–ü–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ‚Äî IP-–∞–¥—Ä–µ—Å.
–í—Ç–æ—Ä–æ–π ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π/—Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (—á–∏—Å–ª–æ).
–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å ‚Äî –ø—Ä–æ–±–µ–ª –∏–ª–∏ —Ç–∞–±—É–ª—è—Ü–∏—è.
### 2. –ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç:
```bash
python huligany1.7.py input.txt
```
### 3. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:
- –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç `ip_rules.json` –∏ `subnet_rules.json` —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏.
- –°–ø—Ä–æ—Å–∏—Ç, —Ö–æ—á–µ—à—å –ª–∏ –≤–≤–µ—Å—Ç–∏ API-–∫–ª—é—á–∏ –¥–ª—è AbuseIPDB –∏ ipinfo.io.
- –°–ø—Ä–æ—Å–∏—Ç, –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ FireHOL.
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç –≤–≤–µ—Å—Ç–∏ —Å–≤–æ–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ —Ñ–∞–π–ª, —á—Ç–æ–±—ã –Ω–µ –≤–≤–æ–¥–∏—Ç—å –∑–∞–Ω–æ–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª
### –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö IP (`ip_rules.json`)
–§–∞–π–ª `ip_rules.json` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:
``` json
[
  { "condition": "AbuseScore >= 80", "description": "–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —É–≥—Ä–æ–∑–∞ (AbuseIPDB)" },
  { "condition": "Feodo_Original == 1", "description": "IP —è–≤–ª—è–µ—Ç—Å—è C&C-—Å–µ—Ä–≤–µ—Ä–æ–º –±–æ—Ç–Ω–µ—Ç–∞" }
]
```
- condition ‚Äî –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ Python (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è `==, !=, >, >=, <, <=, and, or, not`)
- –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è:
`AbuseScore`, `Count`, `AS`, `Feodo_Original`, `firehol_level1`, `firehol_level2`, `firehol_level3`, `BlocklistDE`, `bruteforceblocker`, `EmergingThreats`, `Country`, `AbuseReports`

**–ü—Ä–∏–º–µ—Ä –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞:**
```json
{ "condition": "Country == 'RU' and AbuseScore >= 50", "description": "–†–æ—Å—Å–∏–π—Å–∫–∏–π IP —Å –≤—ã—Å–æ–∫–∏–º AbuseScore" }
```
### –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–æ–¥—Å–µ—Ç–µ–π /24 (`subnet_rules.json`)
–§–∞–π–ª `subnet_rules.json` —É–ø—Ä–∞–≤–ª—è–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π —Ü–µ–ª—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π.
–ü—Ä–∏–º–µ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª:
```json
[
  { "condition": "blocked_ips >= 4", "description": "‚â• 4 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å /24" },
  { "condition": "total_events >= 15 and blocked_ips >= 1", "description": "‚â• 15 —Å–æ–±—ã—Ç–∏–π + ‚â• 1 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π IP ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å /24" }
]
```
- `blocked_ips` ‚Äî —Å–∫–æ–ª—å–∫–æ IP –≤ –ø–æ–¥—Å–µ—Ç–∏ –ø–æ–ø–∞–ª–∏ –ø–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É.
- `total_events` ‚Äî –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤ –ø–æ–¥—Å–µ—Ç–∏.
–ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å —É—Å–ª–æ–≤–∏—è –ø–æ–¥ —Å–≤–æ—é –ø–æ–ª–∏—Ç–∏–∫—É.
### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
–°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤–≤–µ—Å—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ:
```bash
üéØ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  –£—Å–ª–æ–≤–∏–µ: Country == 'CN' and AbuseScore >= 60
  –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –ö–∏—Ç–∞–π—Å–∫–∏–µ –∞–¥—Ä–µ—Å–∞ —Å –≤—ã—Å–æ–∫–∏–º AbuseScore
```
- –£—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º IP.
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–ø–∞–¥—ë—Ç –≤ –æ—Ç—á—ë—Ç –∏ –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ blocklist-—Ñ–∞–π–ª–∞.
## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã
–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É:
```
results/YYYY-MM-DD_HHMM/
```
–í–Ω—É—Ç—Ä–∏ –±—É–¥—É—Ç:
- blocklist.txt ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ IP –∏ –ø–æ–¥—Å–µ—Ç–µ–π, —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö –∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ.
- .csv ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ (–º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ Excel).
- _report.html ‚Äî –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç—á—ë—Ç —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π, –ø–æ–∏—Å–∫–æ–º –∏ –≥—Ä–∞—Ñ–∏–∫–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º.
## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
–ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (API-–∫–ª—é—á–∏, –≤—ã–±–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è FireHOL, –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞) –≤ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- –í –∫–æ–Ω—Ü–µ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç —Å–ø—Ä–æ—Å–∏—Ç:
```bash
–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥? [y/N]:
```
- –§–∞–π–ª –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω —Å –∏–º–µ–Ω–µ–º `<–∏–º—è>.huligany1.7.config.json` —Ä—è–¥–æ–º —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º.
- –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ ‚Äî —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
## –°–æ–≤–µ—Ç—ã
- –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 80 ‚Üí 75), —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `ip_rules.json`, –∞ –Ω–µ –∫–æ–¥.
- –ï—Å–ª–∏ —É —Ç–µ–±—è —Ä–∞–∑–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –ª–æ–≥–æ–≤, –ø–æ–¥–±–∏—Ä–∞–π `subnet_rules.json` –ø–æ–¥ —Å–≤–æ—é –∑–∞–¥–∞—á—É.
- –î–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ —É–¥–æ–±–Ω–æ –¥–µ—Ä–∂–∞—Ç—å —à–∞–±–ª–æ–Ω—ã `ip_rules.json` –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ip_rules_loose.json`, `ip_rules_strict.json`) –∏ –ø–æ–¥–º–µ–Ω—è—Ç—å —Ñ–∞–π–ª –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–∫–æ—Ä–æ—Ç–∫–∏–µ –ª–æ–≥–∏ / –¥–ª–∏–Ω–Ω—ã–µ –ª–æ–≥–∏) –∏ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è.






