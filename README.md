# huligany
**huligany**  ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤,  –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏ –∏—Ö —É–≥—Ä–æ–∑—ã –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ. 
## –ó–∞–ø—É—Å–∫
### 1. –ü–æ–¥–≥–æ—Ç–æ–≤—å –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Ñ–æ—Ä–º–∞—Ç–∞:
```
IP	Count
1.2.3.4	15
5.6.7.8	3
9.10.11.12	4
```
- –ü–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ‚Äî IP-–∞–¥—Ä–µ—Å.
- –í—Ç–æ—Ä–æ–π ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π/—Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (—á–∏—Å–ª–æ).
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å ‚Äî –ø—Ä–æ–±–µ–ª –∏–ª–∏ —Ç–∞–±—É–ª—è—Ü–∏—è.

### 2. –ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç:
üìå –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:
1. –†–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä—É–π –∞—Ä—Ö–∏–≤ –≤ –ª—é–±—É—é –ø–∞–ø–∫—É.
2. –ü–æ–ª–æ–∂–∏ input.txt –≤ —Ç—É –∂–µ –ø–∞–ø–∫—É.
3. –í—ã–ø–æ–ª–Ω–∏:
```bash
python huligany1.7.py input.txt
```
### 3. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:
- –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç `ip_rules.json` –∏ `subnet_rules.json` —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º–∏.
- –°–ø—Ä–æ—Å–∏—Ç, —Ö–æ—á–µ—à—å –ª–∏ –≤–≤–µ—Å—Ç–∏ API-–∫–ª—é—á–∏ –¥–ª—è `AbuseIPDB` (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å [–∑–¥–µ—Å—å](https://www.abuseipdb.com/account/api)), –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ —Ä–µ—Å—É—Ä—Å–µ) –∏ `ipinfo.io` (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å [–∑–¥–µ—Å—å](https://ipinfo.io/dashboard/token)).
- –°–ø—Ä–æ—Å–∏—Ç, –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ FireHOL.
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç –≤–≤–µ—Å—Ç–∏ —Å–≤–æ–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ —Ñ–∞–π–ª, —á—Ç–æ–±—ã –Ω–µ –≤–≤–æ–¥–∏—Ç—å –∑–∞–Ω–æ–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

> **–í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç!** 
>–£ —Ç–æ–∫–µ–Ω–∞ **abuseipdb** –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ –≤–∏–¥–µ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –±–æ–ª—å—à–µ 1000 –∑–∞–ø—Ä–æ—Å–æ–≤, —Ç–æ –Ω–∞–π—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –∏ –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ —Å–∫—Ä–∏–ø—Ç. –°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤–∞–º –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã. –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–π–¥–µ—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω –ø—Ä–∏ –∏–∑—Ä–∞—Å—Ö–æ–¥–æ–≤–∞–Ω–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å [—Ç—É—Ç](https://www.abuseipdb.com/account/api)
>–°—Ö–æ–∂–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –≤ **ipinfo.io**, –Ω–æ –∑–¥–µ—Å—å —è—Å–Ω–æ—Å—Ç–∏ –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–∏. –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —É–∫–∞–∑–∞–Ω–æ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –≤ –º–µ—Å—è—Ü –ø–æ —Ç–∞—Ä–∏—Ñ–Ω–æ–º—É –ø–ª–∞–Ω—É IPinfo Lite, –∫–æ—Ç–æ—Ä—ã–π –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–∫—Ä–∏–ø—Ç–µ. –ù–æ –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –≤ —Å–∫—Ä–∏–ø—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤. –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è [—Ç—É—Ç](https://ipinfo.io/pricing). –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º IPinfo –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å [—Ç—É—Ç](https://ipinfo.io/dashboard/lite)

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª
### –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö IP (`ip_rules.json`)
–§–∞–π–ª `ip_rules.json` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:
``` json
[
  { "condition": "AbuseScore >= 80", "description": "–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —É–≥—Ä–æ–∑–∞ (AbuseIPDB)" },
  { "condition": "Feodo_Original == 1", "description": "IP —è–≤–ª—è–µ—Ç—Å—è C&C-—Å–µ—Ä–≤–µ—Ä–æ–º –±–æ—Ç–Ω–µ—Ç–∞" }
]
```
- condition ‚Äî –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ Python (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è `==, !=, >, >=, <, <=, and, or, not`)
- –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è:
`AbuseScore`, `Count`, `AS`, `Feodo_Original`, `firehol_level1`, `firehol_level2`, `firehol_level3`, `BlocklistDE`, `bruteforceblocker`, `EmergingThreats`, `Country`, `AbuseReports`

**–ü—Ä–∏–º–µ—Ä –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞:**
```json
{ "condition": "Country == 'RU' and AbuseScore >= 50", "description": "–†–æ—Å—Å–∏–π—Å–∫–∏–π IP —Å –≤—ã—Å–æ–∫–∏–º AbuseScore" }
```
### –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è –ø–æ–¥—Å–µ—Ç–µ–π /24 (`subnet_rules.json`)
–§–∞–π–ª `subnet_rules.json` —É–ø—Ä–∞–≤–ª—è–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π —Ü–µ–ª—ã—Ö –ø–æ–¥—Å–µ—Ç–µ–π.
–ü—Ä–∏–º–µ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª:
```json
[
  { "condition": "blocked_ips >= 4", "description": "‚â• 4 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å /24" },
  { "condition": "total_events >= 15 and blocked_ips >= 1", "description": "‚â• 15 —Å–æ–±—ã—Ç–∏–π + ‚â• 1 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π IP ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å /24" }
]
```
- `blocked_ips` ‚Äî —Å–∫–æ–ª—å–∫–æ IP –≤ –ø–æ–¥—Å–µ—Ç–∏ –ø–æ–ø–∞–ª–∏ –ø–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É.
- `total_events` ‚Äî –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤ –ø–æ–¥—Å–µ—Ç–∏.
–ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å —É—Å–ª–æ–≤–∏—è –ø–æ–¥ —Å–≤–æ—é –ø–æ–ª–∏—Ç–∏–∫—É.
### –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
–°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤–≤–µ—Å—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ.
–ü—Ä–∏–º–µ—Ä—ã:
```bash
üéØ –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  –£—Å–ª–æ–≤–∏–µ: Country == 'CN' and AbuseScore >= 60
  –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –ö–∏—Ç–∞–π—Å–∫–∏–µ –∞–¥—Ä–µ—Å–∞ —Å –≤—ã—Å–æ–∫–∏–º AbuseScore
```
```bash
  –£—Å–ª–æ–≤–∏–µ: Country == 'RU' and AbuseScore >= 80
  –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∞ ‚Äî –†–æ—Å—Å–∏—è –ò —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ ‚â•80
```
```bash
  –£—Å–ª–æ–≤–∏–µ: Feodo_Original == 1 or firehol_level1 == 1
  –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ IP –µ—Å—Ç—å –≤ Feodo –ò–õ–ò –≤ FireHOL Level1
```
```bash
  –£—Å–ª–æ–≤–∏–µ: AbuseScore >= 70 and Count >= 5 and Country != 'RU'
  –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ AbuseScore ‚â•70, Count ‚â•5, –ò —Å—Ç—Ä–∞–Ω–∞ –ù–ï –†–æ—Å—Å–∏—è
```
- –£—Å–ª–æ–≤–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º IP.
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–ø–∞–¥—ë—Ç –≤ –æ—Ç—á—ë—Ç –∏ –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ blocklist-—Ñ–∞–π–ª–∞.
## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã
–í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫—É:
```
results/YYYY-MM-DD_HHMM/
```
–í–Ω—É—Ç—Ä–∏ –±—É–¥—É—Ç:
- blocklist.txt ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ IP –∏ –ø–æ–¥—Å–µ—Ç–µ–π, —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö –∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ.
- .csv ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ (–º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤ Excel).
- _report.html ‚Äî –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç—á—ë—Ç —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π, –ø–æ–∏—Å–∫–æ–º –∏ –≥—Ä–∞—Ñ–∏–∫–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º.
## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
–ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (API-–∫–ª—é—á–∏, –≤—ã–±–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è FireHOL, –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞) –≤ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
- –í –∫–æ–Ω—Ü–µ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç —Å–ø—Ä–æ—Å–∏—Ç:
```bash
–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥? [y/N]:
```
- –§–∞–π–ª –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω —Å –∏–º–µ–Ω–µ–º `<–∏–º—è>.huligany1.7.config.json` —Ä—è–¥–æ–º —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º.
- –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ ‚Äî —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
## –°–æ–≤–µ—Ç—ã
- –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 80 ‚Üí 75), —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `ip_rules.json`, –∞ –Ω–µ –∫–æ–¥.
- –ï—Å–ª–∏ —É —Ç–µ–±—è —Ä–∞–∑–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –ª–æ–≥–æ–≤, –ø–æ–¥–±–∏—Ä–∞–π `subnet_rules.json` –ø–æ–¥ —Å–≤–æ—é –∑–∞–¥–∞—á—É.
- –î–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ —É–¥–æ–±–Ω–æ –¥–µ—Ä–∂–∞—Ç—å —à–∞–±–ª–æ–Ω—ã `ip_rules.json` –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ip_rules_loose.json`, `ip_rules_strict.json`) –∏ –ø–æ–¥–º–µ–Ω—è—Ç—å —Ñ–∞–π–ª –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–∫–æ—Ä–æ—Ç–∫–∏–µ –ª–æ–≥–∏ / –¥–ª–∏–Ω–Ω—ã–µ –ª–æ–≥–∏) –∏ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è.
–°–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω —Å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–æ–π –∫–æ–¥–∞ —Å—Ç—Ä–∞–Ω—ã: [2letter-country.xlsx](https://github.com/user-attachments/files/22606797/2letter-country.xlsx)
### –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤

| **–°—Ç–æ–ª–±–µ—Ü**       | **–û–ø–∏—Å–∞–Ω–∏–µ**                                                             | **–ò—Å—Ç–æ—á–Ω–∏–∫**                                         |
| ----------------- | ------------------------------------------------------------------------ | ---------------------------------------------------- |
| IP                | –ò—Å—Ö–æ–¥–Ω—ã–π IP-–∞–¥—Ä–µ—Å –∏–∑ –ª–æ–≥–æ–≤                                               | ‚Äî                                                    |
| Count             | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ä–∞–±–æ—Ç–æ–∫ –°–ó–ò —Å —ç—Ç–æ–≥–æ IP                                       | ‚Äî                                                    |
| /24               | –°–µ—Ç—å —Å –º–∞—Å–∫–æ–π /24 (–Ω–∞–ø—Ä–∏–º–µ—Ä, 192.168.1.0)                                | –†–∞—Å—á—ë—Ç –ø–æ IP                                         |
| Count/24          | –°—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ä–∞–±–æ—Ç–æ–∫ –≤ –ø–æ–¥—Å–µ—Ç–∏ /24                              | –ê–≥—Ä–µ–≥–∞—Ü–∏—è                                            |
| AS                | –ù–æ–º–µ—Ä –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (ASN)                                           | https://ipinfo.io/developers/lite-api                |
| AS Name           | –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –≤–ª–∞–¥–µ—é—â–µ–π ASN                                      | https://ipinfo.io/developers/lite-api                |
| Country           | –ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, US, RU)                                            | https://ipinfo.io/developers/lite-api                |
| Count/AS          | –°—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ä–∞–±–æ—Ç–æ–∫ –ø–æ ASN                                     | –ê–≥—Ä–µ–≥–∞—Ü–∏—è                                            |
| AbuseScore        | –£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è —É–≥—Ä–æ–∑—ã (0‚Äì100%)                                          | https://www.abuseipdb.com/                           |
| AbuseReports      | –ß–∏—Å–ª–æ –∂–∞–ª–æ–± –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π                                         | https://www.abuseipdb.com/                           |
| BlocklistDE       | 1 –µ—Å–ª–∏ IP –≤ —Å–ø–∏—Å–∫–µ –∞—Ç–∞–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ã blocklist.de                          | https://www.blocklist.de/ru/index.html               |
| Feodo_Original    | 1 –µ—Å–ª–∏ IP ‚Äî C&C-—Å–µ—Ä–≤–µ—Ä –±–æ—Ç–Ω–µ—Ç–∞ (Emotet, TrickBot)                        | https://feodotracker.abuse.ch/                       |
| EmergingThreats   | 1 –µ—Å–ª–∏ IP —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω (–±–æ—Ç, –∑–æ–º–±–∏)                                  | https://rules.emergingthreats.net/                   |
| firehol_level1    | 1 –µ—Å–ª–∏ IP –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–ø–∏—Å–∫–µ —É–≥—Ä–æ–∑ FireHOL                                | https://iplists.firehol.org/?ipset=firehol_level1    |
| firehol_level2    | –£–º–µ—Ä–µ–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å —É–≥—Ä–æ–∑—ã (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ –∞—Ç–∞–∫–∏)                          | https://iplists.firehol.org/?ipset=firehol_level2    |
| firehol_level3    | –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å (–º–∏–Ω–∏–º—É–º –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)                      | https://iplists.firehol.org/?ipset=firehol_level3    |
| feodo             | 1 –µ—Å–ª–∏ IP –≤ —Å–ø–∏—Å–∫–µ Feodo (—á–µ—Ä–µ–∑ FireHOL)                                 | https://iplists.firehol.org/?ipset=feodo_badips      |
| bruteforceblocker | 1 –µ—Å–ª–∏ IP –∞—Ç–∞–∫—É–µ—Ç SSH/RDP (‚â•3 –∂–∞–ª–æ–±—ã)                                    | https://iplists.firehol.org/?ipset=bruteforceblocker |
| Action            | –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å IP –∞–¥—Ä–µ—Å–æ–º                                       | ‚Äî                                                    |
| Reason            | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–ª—è Action                                                  | ‚Äî                                                    |
| CustomReason      | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –µ—Å–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –ø–æ –∫–∞—Å—Ç–æ–º–Ω–æ–º—É –∫—Ä–∏—Ç–µ—Ä–∏—é | ‚Äî                                                    |

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è **`Action = "Block"`**:

| **–£—Å–ª–æ–≤–∏–µ**                       | **–ü–æ—è—Å–Ω–µ–Ω–∏–µ**                                              |
| --------------------------------- | ---------------------------------------------------------- |
| `AbuseScore >= 80`                | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è —É–≥—Ä–æ–∑–∞ (AbuseIPDB)             |
| `Feodo_Original == 1`             | IP —è–≤–ª—è–µ—Ç—Å—è C&C-—Å–µ—Ä–≤–µ—Ä–æ–º –±–æ—Ç–Ω–µ—Ç–∞ (Emotet, TrickBot –∏ –¥—Ä.)  |
| `firehol_level1 == 1`             | IP –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–ø–∏—Å–∫–µ FireHOL (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —É–≥—Ä–æ–∑—ã)       |
| `BlocklistDE == 1`                | IP –∞—Ç–∞–∫–æ–≤–∞–ª —Å–µ—Ä–≤–µ—Ä—ã blocklist.de (SSH/FTP –±—Ä—É—Ç—Ñ–æ—Ä—Å)        |
| `bruteforceblocker == 1`          | IP –∑–∞–º–µ—á–µ–Ω –≤ –±—Ä—É—Ç—Ñ–æ—Ä—Å–µ (‚â•3 –∂–∞–ª–æ–±—ã –æ—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) |
| `AbuseScore >= 70 AND Count >= 5` | –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –∞–≥—Ä–µ—Å—Å–æ—Ä: –≤—ã—Å–æ–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ + —á–∞—Å—Ç—ã–µ —Å—Ä–∞–±–æ—Ç–∫–∏     |






